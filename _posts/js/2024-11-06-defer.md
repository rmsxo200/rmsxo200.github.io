---
title:  "[JavaScript] JS 로딩 및 실행시점 조절"
toc: true
toc_sticky: true
toc_label: "목차"
categories:
  - js
---

# script태그의 위치 조정
<br/>
자바스크립트의 실행시점을 조절하기 위해 body태그 최하단에 두어 HTML 파싱후 스크립트가 실행되게끔 하는 방법이 있다.  
위 방법 사용시 자바스크립트가 HTML 요소에 의존하는 경우 해당 요소들이 이미 파싱되어 있음을 보장할 수 있다.  
<br/>
위처럼 위치를 변경하는 방법 외에 아래 방법들로도 실행 시점을 조절할 수 있다.
<br/>
<br/>
# 1.defer
```
<script defer src="script.js">
```
script 태그를 만나도 HTML 파싱이 중단되지 않고 끝난 뒤에 script가 실행된다.  
  
* 브라우저는 `defer` 속성이 있는 스크립트를 '백그라운드’에서 다운로드 한다.  
* 따라서 스크립트를 다운로드 하는 도중에도 HTML 파싱이 멈추지 않는다.  
* 그리고 defer 스크립트 실행은 페이지 구성이 끝날 때까지 지연된다 .  
* DOM이 준비된 후에 실행되긴 하지만 `DOMContentLoaded` 이벤트 발생 전에 실행된다.
  
```
<script defer src="script1.js">
<script defer src="script2.js">
```
스크립트가 여러개 명시되어 있다면 모두 다운로드된 후에 실행된다.  
* defer 속성은 외부 스크립트에만 유효하다. <script>에 src가 없으면 `defer` 속성은 무시된다.

<br/>
<br/>
# 2.async
```
<script async src="script.js">
```
script 태그를 만나도 HTML 파싱이 중단되지 않고 스크립트가 로드된 후에는 HTML 파싱을 멈추고 스크립트가 실행된다.  
그리고 스크립트가 실행되고난 뒤애 다시 HTML 파싱을 한다.  
  
* `async` 스크립트는 `defer` 스크립트와 마찬가지로 백그라운드에서 다운로드 된다.  
* `async` 속성이 붙은 스크립트는 페이지와 완전히 독립적으로 동작한다.  
* 다른 스크립트들은 `async` 스크립트를 기다리지 않는다.  
* async 스크립트 역시 다른 스크립트들을 기다리지 않는다.  
* 이런 특징 때문에 페이지에 `async` 스크립트가 여러 개 있는 경우 그 실행 순서가 제각각이 된다.  
* 실행은 다운로드가 끝난 스크립트 순으로 진행된다.  
  
또한 `DOMContentLoaded` 이벤트와 `async` 스크립트는 서로를 기다리지 않는다.  
페이지 구성이 끝난 후에 `async` 스크립트 다운로딩이 끝난 경우 `DOMContentLoaded`는 `async` 스크립트 실행 전에 발생할 수 있다.  
async 스크립트가 짧아서 페이지 구성이 끝나기 전에 다운로드 되거나 스크립트가 캐싱처리 된 경우, `DOMContentLoaded`는 `async` 스크립트 실행 후에 발생할 수도 있다.  
  
비동기 스크립트는 방문자 수 카운터나 광고 관련 스크립트처럼 각각 독립적인 역할을 하는 서드 파티 스크립트를 현재 개발 중인 스크립트에 통합하려 할 때 아주 유용하다. 
다른 스크립트에 의존하지 않고, 그 반대도 마찬가지이기 때문이다.



